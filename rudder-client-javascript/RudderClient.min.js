function generateUUID(){var e=new Date.getTime();typeof performance!=='undefined'&&typeof performance.now==='function'&&(e+=performance.now());return'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g,function(t){var r=(e+Math.random()*16)%16|0;e=Math.floor(e/16);return(t==='x'?r:r&3|8).toString(16)})}function getCurrentTimeFormatted(){var e=new Date.toISOString(),t=e.split('T')[0],r=e.split('T')[1].split('Z')[0].split('.')[0],n=e.split('Z')[0].split('.')[1];return t+" "+r+"+"+n}function getJSON(e,t){if(typeof window==='undefined')var r=require("xmlhttprequest").XMLHttpRequest;var n=new r;n.open('get',e,!0);n.responseType='json';n.onload=function(){var e=n.status;e==200?t(null,n.response):t(e)};n.send()}var MessageType={TRACK:"track",PAGE:"page",IDENTIFY:"identify"},ECommerceParamNames={QUERY:"query",PRICE:"price",PRODUCT_ID:"product_id",CATEGORY:"category",CURRENCY:"currency",LIST_ID:"list_id",PRODUCTS:"products",WISHLIST_ID:"wishlist_id",WISHLIST_NAME:"wishlist_name",QUANTITY:"quantity",CART_ID:"cart_id",CHECKOUT_ID:"checkout_id",TOTAL:"total",REVENUE:"revenue",ORDER_ID:"order_id"},ECommerceEvents={PRODUCTS_SEARCHED:"Products Searched",PRODUCT_LIST_VIEWED:"Product List Viewed",PRODUCT_LIST_FILTERED:"Product List Filtered",PROMOTION_VIEWED:"Promotion Viewed",PROMOTION_CLICKED:"Promotion Clicked",PRODUCT_CLICKED:"Product Clicked",PRODUCT_VIEWED:"Product Viewed",PRODUCT_ADDED:"Product Added",PRODUCT_REMOVED:"Product Removed",CART_VIEWED:"Cart Viewed",CHECKOUT_STARTED:"Checkout Started",CHECKOUT_STEP_VIEWED:"Checkout Step Viewed",CHECKOUT_STEP_COMPLETED:"Checkout Step Completed",PAYMENT_INFO_ENTERED:"Payment Info Entered",ORDER_UPDATED:"Order Updated",ORDER_COMPLETED:"Order Completed",ORDER_REFUNDED:"Order Refunded",ORDER_CANCELLED:"Order Cancelled",COUPON_ENTERED:"Coupon Entered",COUPON_APPLIED:"Coupon Applied",COUPON_DENIED:"Coupon Denied",COUPON_REMOVED:"Coupon Removed",PRODUCT_ADDED_TO_WISHLIST:"Product Added to Wishlist",PRODUCT_REMOVED_FROM_WISHLIST:"Product Removed from Wishlist",WISH_LIST_PRODUCT_ADDED_TO_CART:"Wishlist Product Added to Cart",PRODUCT_SHARED:"Product Shared",CART_SHARED:"Cart Shared",PRODUCT_REVIEWED:"Product Reviewed"},RudderIntegrationPlatform={RUDDERLABS:"rudderlabs",GA:"ga",AMPLITUDE:"amplitude"};let BASE_URL="https://rudderlabs.com",FLUSH_QUEUE_SIZE=30;class RudderProperty{constructor(){this.propertyMap={}}getPropertyMap(){return this.propertyMap}getProperty(e){return this.propertyMap[e]}setProperty(e,t){this.propertyMap[e]=t}setPropertyMap(e){this.propertyMap?Object.keys(e).forEach(t=>{this.propertyMap[t]=e[t]}):(this.propertyMap=e)}}class PagePropertyBuilder{constructor(){this.title="";this.url="";this.path="";this.referrer="";this.search="";this.keywords=""}build(){if(!this.url||0===this.url.length){throw new Error("Page url cannot be null or empty")}var e=new RudderProperty;e.setProperty("title",this.title);e.setProperty("url",this.url);e.setProperty("path",this.path);e.setProperty("referrer",this.referrer);e.setProperty("search",this.search);e.setProperty("keywords",this.keywords);return e}setTitle(e){this.title=e;return this}setUrl(e){this.url=e;return this}setPath(e){this.path=e;return this}setReferrer(e){this.referrer=e;return this}setSearch(e){this.search=e;return e}setKeywords(e){this.keywords=e;return this}}class ScreenPropertyBuilder{constructor(){this.name=""}build(){if(!this.name||0===this.name){throw new Error("Screen name cannot be null or empty")}var e=new RudderProperty;e.setProperty("name",this.name);return e}}class ECommerceOrder{contructor(){this.order_id="";this.affiliation="";this.total=0;this.value=0;this.revenue=0;this.shipping=0;this.tax=0;this.discount=0;this.coupon="";this.currency="";this.products=[]}}class ECommerceProduct{constructor(){this.product_id="";this.sku="";this.category="";this.name="";this.brand="";this.variant="";this.price=0;this.currency="";this.quantity=0;this.coupon="";this.position=0;this.url="";this.image_url=""}setProductId(e){this.product_id=e;return this}setSku(e){this.sku=e;return this}setCategory(e){this.category=e;return this}setName(e){this.name=e;return this}setBrand(e){this.brand=e;return this}setVariant(e){this.variant=e;return this}setPrice(e){this.price=e;return this}setCurrency(e){this.currency=e;return this}setQuantity(e){this.quantity=e;return this}setCoupon(e){this.coupon=e;return e}setPosition(e){this.position=e;return this}setUrl(e){this.url=e;return this}setImageUrl(e){this.image_url=e;return this}}class ECommercePromotion{constructor(){this.promotion_id="";this.creative="";this.name="";this.position=0}}class ECommerceCart{constructor(){this.cart_id="";this.products=[]}addProducts(e){e&&this.products.pushValues(e)}addProduct(e){e&&this.products.push(e)}}class ECommerceCoupon{constructor(){this.cart_id="";this.order_id="";this.coupon_id="";this.coupon_name="";this.discount=0;this.reason=""}}class ECommerceWishList{constructor(){this.wishlist_id="";this.wishlist_name=""}}class ECommerceCheckout{constructor(){this.checkout_id="";this.order_id="";this.step="";this.shipping_method="";this.payment_method=""}}class CheckoutStartedEvent{constructor(){this.order=null;this.checkout=null}event(){return ECommerceEvents.CHECKOUT_STARTED}build(){var e=new RudderProperty;e.setProperty(this.order);e.setProperty(this.checkout);return e}}class OrderCompletedEvent{constructor(){this.order=null}event(){return ECommerceEvents.ORDER_COMPLETED}build(){var e=new RudderProperty;e.setProperty(this.order)}}class ProductAddedToCartEvent{contructor(){this.product=null;this.cartId=null}event(){return ECommerceEvents.PRODUCT_ADDED}build(){var e=new RudderProperty;e.setPropertyMap(this.product);e.setProperty(ECommerceParamNames.CART_ID,this.cartId);return e}setProduct(e){this.product=e;return this}setCartId(e){this.cartId=e;return this}}class ProductAddedToWishlistEvent{contructor(){this.product=null;this.cartId=null}event(){return ECommerceEvents.PRODUCT_ADDED}build(){var e=new RudderProperty;e.setProperty(this.product);e.setProperty(ECommerceEvents.PRODUCT_ADDED,this.cartId);return e}}class ProductListViewedEvent{constructor(){this.listId=null;this.category=null;this.products=[]}addProducts(e){this.products?this.products.pushValues(e):(this.products=e)}addProduct(e){this.products||(this.products=[]);this.products.push(e)}event(){return ECommerceEvents.PRODUCT_LIST_VIEWED}build(){var e=new RudderProperty;e.setProperty(ECommerceParamNames.LIST_ID,this.listId);e.setProperty(ECommerceParamNames.CATEGORY,this.category);e.setProperty(ECommerceParamNames.PRODUCTS,this.products);return e}}class ProductRemovedEvent{constructor(){this.product=null}event(){return ECommerceEvents.PRODUCT_REMOVED}build(){var e=new RudderProperty;e.setProperty(this.product);return e}}class ProductSearchedEvent{constructor(){this.query=null}event(){return ECommerceEvents.PRODUCTS_SEARCHED}build(){var e=new RudderProperty;e.setProperty(ECommerceParamNames.QUERY,this.query);return e}}class ProductViewedEvent{constructor(){this.product=null}event(){return ECommerceEvents.PRODUCT_VIEWED}build(){var e=new RudderProperty;e.setProperty(this.product);return e}}var RudderConfig=(function(){var e;function t(){var e=BASE_URL;[];return{getDefaultIntegrations:function(){return[]},getEndPointUri:function(){return e},getFlushQueueSize:function(){return this.flushQueueSize},getIntegrations:function(){return this.integrations},setIntegrations:function(e){this.integrations=e;return this},setFlushQueueSize:function(e){this.flushQueueSize=e;return this},setEndPointUri:function(e){this.endPointUri=e;return this}}}return{getDefaultConfig:function(){e||(e=t());return e}}})();class EventRepository{constructor(e,t){this.eventsBuffer=[];this.write_key=e;this.rudderConfig=t}flush(e){this.eventsBuffer=[];this.eventsBuffer.push(e);var t=new RudderPayload;t.batch=this.eventsBuffer;t.write_key=this.write_key;t.sent_at=getCurrentTimeFormatted();if(typeof window==='undefined')var r=require("xmlhttprequest").XMLHttpRequest;var n=new r;console.log(JSON.stringify(t));n.open("POST",this.rudderConfig.getEndPointUri(),!0);n.setRequestHeader("Content-Type","application/json");n.onreadystatechange=function(){n.readyState===4&&n.status===200&&(this.eventsBuffer=[])};n.send(JSON.stringify(t))}}class RudderPayload{constructor(){this.batch=null;this.write_key=null}}class RudderElement{constructor(){this.rl_message=new RudderMessage}setType(e){this.rl_message.rl_type=e}setProperty(e){this.rl_message.rl_properties=e}setUserId(e){this.rl_message.rl_user_id=e}setEventName(e){this.rl_message.rl_event=e}updateTraits(e){this.rl_message.rl_context.rl_traits=e}}class RudderElementBuilder{constructor(){this.rudderProperty=null;this.event=null;this.userId=null;this.channel=null}setProperty(e){this.rudderProperty=e;return this}setPropertyBuilder(e){this.rudderProperty=e.build();return this}setEvent(e){this.event=e;return this}setUserId(e){this.userId=e;return this}setChannel(e){this.channel=e;return this}build(){var e=new RudderElement;e.setUserId(this.userId);e.setEventName(this.event);e.setProperty(this.rudderProperty);return e}}class RudderMessage{constructor(){this.rl_channel="web";this.rl_context=new RudderContext;this.rl_type=null;this.rl_action=null;this.rl_message_id=generateUUID().toString();this.rl_timestamp=new Date.getTime();this.rl_anonymous_id=generateUUID().toString();this.rl_user_id=null;this.rl_event=null;this.rl_properties={};this.rl_integrations={};this.rl_integrations.all=!0}getProperty(e){return this.rl_properties[e]}addProperty(e,t){this.rl_properties[e]=t}validateFor(e){if(!this.rl_properties){throw new Error("Key rl_properties is required")}switch(e){case MessageType.TRACK:if(!this.rl_event){throw new Error("Key rl_event is required for track event")};if(this.rl_event in Object.values(ECommerceEvents)){switch(rl_event){case ECommerceEvents.CHECKOUT_STEP_VIEWED:;case ECommerceEvents.CHECKOUT_STEP_COMPLETED:;case ECommerceEvents.PAYMENT_INFO_ENTERED:checkForKey("checkout_id");checkForKey("step");break;case ECommerceEvents.PROMOTION_VIEWED:;case ECommerceEvents.PROMOTION_CLICKED:checkForKey("promotion_id");break;case ECommerceEvents.ORDER_REFUNDED:checkForKey("order_id");break;default:}}else this.rl_properties.category||(this.rl_properties.category=this.rl_event);break;case MessageType.PAGE:break;case MessageType.SCREEN:if(!this.rl_properties.name){throw new Error("Key 'name' is required in rl_properties")};break}}checkForKey(e){if(!this.rl_properties[e]){throw new Error("Key '"+e+"' is required in rl_properties")}}}class RudderContext{constructor(){this.rl_app=new RudderApp;this.rl_traits=null;this.rl_library=new RudderLibraryInfo;var e=new RudderOSInfo;e.rl_version="";var t=new RudderScreenInfo;typeof window==='undefined'?(t.rl_width=0,t.rl_height=0,t.rl_density=0,e.rl_version="",e.rl_name="",this.rl_user_agent=null,this.rl_locale=null):(t.rl_width=window.width,t.rl_height=window.height,t.rl_density=window.devicePixelRatio,this.rl_user_agent=navigator.userAgent,this.rl_locale=navigator.language||navigator.browserLanguage);this.screen=t;this.rl_device=null;this.rl_network=null}}class RudderApp{constructor(){this.rl_build="1.0.0";this.rl_name="RudderLabs JavaScript SDK";this.rl_namespace="com.rudderlabs.javascript";this.rl_version="1.0.0"}}class RudderTraits{constructor(){this.rl_address=null;this.rl_age=null;this.rl_birthday=null;this.rl_company=null;this.rl_createdat=null;this.rl_description=null;this.rl_email=null;this.rl_firstname=null;this.rl_gender=null;this.rl_id=null;this.rl_lastname=null;this.rl_name=null;this.rl_phone=null;this.rl_title=null;this.rl_username=null}setAddress(e){this.rl_address=e;return this}setAge(e){this.rl_age=e;return this}setBirthday(e){this.rl_birthday=e;return this}setCompany(e){this.rl_company=e;return this}setCreatedAt(e){this.rl_createdat=createdAt;return this}setDescription(e){this.rl_description=e;return this}setEmail(e){this.rl_email=e;return this}setFirstname(e){this.rl_firstname=e;return this}setId(e){this.rl_id=e;return this}setLastname(e){this.rl_lastname=e;return this}setName(e){this.rl_name=e;return this}setPhone(e){this.rl_phone=e;return this}setTitle(e){this.rl_title=e;return this}setUsername(e){this.rl_username=e;return this}}class TraitsAddress{constructor(){this.rl_city="";this.rl_country="";this.rl_postalcode="";this.rl_state="";this.rl_street=""}}class TraitsCompany{constructor(){this.rl_name="";this.rl_id="";this.rl_industry=""}}class RudderLibraryInfo{constructor(){this.rl_name="RudderLabs JavaScript SDK";this.rl_version="1.0.0"}}class RudderOSInfo{constructor(){this.rl_name="";this.rl_version=""}}class RudderScreenInfo{constructor(){this.rl_density=0;this.rl_width=0;this.rl_height=0}}class RudderDeviceInfo{constructor(){this.rl_id="";this.rl_manufacturer="";this.rl_model="";this.rl_name=""}}class RudderNetwork{constructor(){this.rl_carrier=""}}var RudderClient=(function(){var e,t;function r(e){e.rl_message&&(e.rl_message.validateFor(MessageType.TRACK),e.rl_message.rl_type=MessageType.TRACK,e.rl_message.rl_properties.category||(e.rl_message.rl_properties.category=e.rl_message.rl_event),t.flush(e))}function n(e){e.rl_message&&(e.rl_message.validateFor(MessageType.PAGE),e.rl_message.rl_type=MessageType.PAGE,t.flush(e))}function u(e){var r=new RudderElementBuilder.setEvent(MessageType.IDENTIFY).setUserId(e.rl_id).build();r.updateTraits(e);r.setType(MessageType.IDENTIFY);t.flush(r)}function o(){return{track:r,page:n,identify:u}}return{getInstance:function(r,n){if(!e){if(!r||0===r.length){throw new Error("writeKey cannot be null or empty")}if(!n){throw new Error("rudderConfig cannot be null")}e=o();t=new EventRepository(r,n);this.rudderConfig=n}return e}}})(),client=RudderClient.getInstance("dummykey",RudderConfig.getDefaultConfig().setFlushQueueSize(1)),props=new RudderProperty;props.setProperty("title","How to create a tracking plan");props.setProperty("course","Intro to Analytics");client.track(new RudderElementBuilder.setEvent("Article Completed").setProperty(props.getPropertyMap()).setUserId("dipanjan").build());client.identify((new RudderTraits).setName("dipanjan").setEmail("dipanjan@rudderlabs.com").setId(generateUUID));client.page(new RudderElementBuilder.setProperty(new PagePropertyBuilder.setTitle("Blog Page").setUrl("https://rudderlabs.com").setPath("/blogs").setReferrer("https://www.rudderlabs.com").build().getPropertyMap()).build());client.track(new RudderElementBuilder.setEvent(ECommerceEvents.PRODUCT_ADDED).setProperty(new ProductAddedToCartEvent.setProduct(new ECommerceProduct.setName("Dummy Product")).setCartId("DummyCartId").build().getPropertyMap()).build())
